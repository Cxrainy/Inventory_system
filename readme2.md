# 基于 Python 的生产物料管理系统

## 项目背景

随着制造业的快速发展，企业对生产物料管理的需求日益增长。传统的物料管理方式效率低下，容易出现数据错误和库存积压等问题，因此，开发一套高效、准确、易用的生产物料管理系统势在必行。

## 项目目标

本项目旨在开发一套基于 Python 的生产物料管理系统，帮助企业实现以下目标：

*   提高物料管理效率，降低库存成本。
*   实时掌握库存状况，及时进行预警和补货。
*   提供准确的物料消耗数据，为企业决策提供支持。

## 一、系统设计

### 1.1 模块化设计

系统采用模块化设计，主要包括以下模块：

*   **系统初始化模块:** 引导用户选择行业模板，并提供模板修改功能，允许用户自定义物料名称和编码规则。
*   **物料管理模块:** 实现物料信息的增删改查，支持批量导入和导出功能。
*   **库存管理模块:** 记录物料的入库、出库和盘点操作，并提供库存预警功能。
*   **报表统计模块:** 生成各种统计报表，如物料出入库统计和库存周转率分析，支持自定义报表功能。
*   **用户权限管理模块:** 设置不同角色的用户权限，如管理员和操作员，保障系统安全。

### 1.2 数据库设计

*   采用 MySQL 关系型数据库存储数据，设计合理的数据库结构，确保数据完整性和一致性。
*   建立物料信息表、库存信息表和出入库记录表等核心数据表，并定义表之间的关联关系。

### 1.3 用户界面设计

*   采用简洁、直观的界面设计风格，方便用户快速上手。
*   提供清晰的操作流程和提示信息，提升用户体验。

### 1.4 技术选型

*   **后端:** Python + Django 框架
*   **前端:** HTML + CSS + JavaScript (可考虑 Vue.js 或 React)
*   **数据库:** MySQL

## 二、功能模块

### 2.1 系统管理模块

*   **用户管理:** 用户注册、登录、密码修改等基本功能。
*   **角色管理:** 设置管理员、操作员等不同角色，分配不同的操作权限。
*   **权限管理:** 针对不同模块的功能进行权限控制，例如：只有管理员可以修改系统设置，操作员只能进行物料出入库操作等。
*   **公司信息管理:** 允许用户填写公司名称、地址、联系方式等基本信息，用于报表打印等场景。设置物料编码规则，支持自定义编码规则和自动生成编码。
*   **系统日志:** 记录系统操作日志，方便追溯操作历史和问题排查。

### 2.2 基础数据模块

*   **物料类别管理:** 建立多级物料类别树，方便物料分类管理。支持类别的新增、修改、删除、排序等操作。
*   **物料信息管理:** 支持从 Excel 模板导入物料信息，包括物料编码、名称、规格型号、单位、安全库存量等。支持手动添加、修改、删除物料信息。
*   **供应商管理:** 记录供应商的名称、联系方式、地址等信息。支持对供应商进行分类管理。
*   **客户管理:** 可选模块，如果公司业务涉及直接面向客户销售产品，可以添加此模块管理客户信息。

### 2.3 库存管理模块

*   **入库管理:** 
    *   支持根据采购订单进行入库操作。
    *   记录入库时间、经手人、仓库等信息。
    *   自动更新库存信息。
*   **出库管理:** 
    *   支持根据生产领料单、销售发货单等进行出库操作。
    *   记录出库时间、经手人、去向等信息。
    *   自动更新库存信息。
*   **库存盘点:** 
    *   支持手动创建盘点单，记录盘点时间、盘点人员等信息。
    *   支持扫描盘点，提高盘点效率。
    *   根据盘点结果调整库存信息。
*   **库存预警:** 
    *   设置物料的最低库存预警值。
    *   当库存低于预警值时，系统自动发出预警提醒。
    *   支持多种预警方式，例如：短信、邮件、系统消息等。

### 2.4 报表统计模块

*   **出入库报表:** 统计一段时间内的物料出入库情况。支持按物料、时间、仓库等条件筛选数据。可以导出 Excel 格式报表。
*   **库存报表:** 实时显示当前库存信息，包括物料数量、库存金额等。支持按仓库、物料类别等条件筛选数据。可以导出 Excel 格式报表。
*   **物料消耗报表:** 统计一段时间内各种物料的消耗情况。支持按物料、时间、部门等条件筛选数据。可以导出 Excel 格式报表。
*   **库存周转率分析:** 计算物料的库存周转率，帮助企业分析库存管理水平。
*   **物料 ABC 分类管理:** 根据物料的重要性进行分类管理，制定不同的库存策略。

### 2.5 数据导入导出模块

*   **模板管理:** 提供预置的行业通用模板，例如：制造业、零售业等。允许用户自定义模板，设置字段和数据校验规则。
*   **数据导入:** 支持 Excel 文件导入，并进行数据校验和处理。提供导入进度提示和结果反馈。
*   **数据导出:** 支持将报表数据导出为 Excel 文件。

## 三、 Django App 设计

为了提高代码的可维护性和可重用性，本项目将采用 Django 的 App 结构进行开发，计划创建以下几个 App：

**核心模块：**

*   **`core`:** 存放系统级别的功能，例如用户管理、权限管理、公司信息管理、系统日志等。
*   **`materials`:**  管理物料相关的功能，包括物料类别管理、物料信息管理、供应商管理等。
*   **`inventory`:**  负责库存管理的功能，包括入库管理、出库管理、库存盘点、库存预警等。
*   **`reports`:**  实现报表统计的功能，包括出入库报表、库存报表、物料消耗报表、库存周转率分析等。

**可选模块：**

*   **`customers`:** 如果系统需要管理客户信息，可以创建该 app。

**数据导入导出模块：**

*   **`data_manager`:**  负责数据导入导出功能，包括模板管理、数据导入、数据导出等。


## 四、 数据库设计

**一、核心模块 (`core`)**

1.  **用户表 (`core_user`)**

    | 字段名        | 数据类型     | 是否为空 | 主键 | 备注                                                         |
    | :------------ | :----------- | :------- | :---- | :----------------------------------------------------------- |
    | id            | int          | 否       | 是    | 自增主键                                                     |
    | username      | varchar(255) | 否       |       | 用户名，唯一                                                 |
    | password      | varchar(128) | 否       |       | 密码，使用哈希算法加密存储                                 |
    | email         | varchar(255) | 是       |       | 邮箱地址                                                     |
    | first_name    | varchar(30)  | 是       |       |                                                              |
    | last_name     | varchar(150) | 是       |       |                                                              |
    | is_staff      | boolean      | 否       |       | 是否为管理员                                                 |
    | is_active     | boolean      | 否       |       | 账号是否激活                                                 |
    | date_joined   | datetime     | 否       |       | 用户注册时间                                                 |
    | company       | int          | 是       |       | 所属公司，外键关联 `core_company` 表                      |

2.  **角色表 (`core_role`)**

    | 字段名 | 数据类型     | 是否为空 | 主键 | 备注             |
    | :----- | :----------- | :------- | :---- | :--------------- |
    | id     | int          | 否       | 是    | 自增主键         |
    | name   | varchar(100) | 否       |       | 角色名称，唯一 |

3.  **用户角色表 (`core_userrole`)**

    | 字段名 | 数据类型 | 是否为空 | 主键 | 备注                                                         |
    | :----- | :------- | :------- | :---- | :----------------------------------------------------------- |
    | id     | int      | 否       | 是    | 自增主键                                                     |
    | user   | int      | 否       |       | 用户 ID，外键关联 `core_user` 表                          |
    | role   | int      | 否       |       | 角色 ID，外键关联 `core_role` 表                          |

4.  **公司信息表 (`core_company`)**

    | 字段名  | 数据类型     | 是否为空 | 主键 | 备注                 |
    | :------ | :----------- | :------- | :---- | :------------------- |
    | id      | int          | 否       | 是    | 自增主键             |
    | name    | varchar(255) | 否       |       | 公司名称             |
    | address | varchar(255) | 是       |       | 公司地址             |
    | contact | varchar(255) | 是       |       | 联系人               |
    | phone   | varchar(20)  | 是       |       | 联系电话             |
    | code_rule | varchar(20)  | 是       |       | 物料编码规则，如：'YYYYMMDDXXXXXX' |

5.  **系统日志表 (`core_systemlog`)**

    | 字段名    | 数据类型     | 是否为空 | 主键 | 备注                     |
    | :-------- | :----------- | :------- | :---- | :------------------------- |
    | id        | int          | 否       | 是    | 自增主键                 |
    | user      | int          | 是       |       | 操作用户，外键关联 `core_user` 表 |
    | operation | varchar(255) | 否       |       | 操作类型，例如：登录、修改密码等 |
    | timestamp | datetime     | 否       |       | 操作时间                 |

**二、物料管理模块 (`materials`)**

1.  **物料类别表 (`materials_category`)**

    | 字段名     | 数据类型     | 是否为空 | 主键 | 备注                                                         |
    | :--------- | :----------- | :------- | :---- | :----------------------------------------------------------- |
    | id         | int          | 否       | 是    | 自增主键                                                     |
    | name       | varchar(255) | 否       |       | 类别名称                                                     |
    | parent     | int          | 是       |       | 父级类别 ID，自关联，允许为空，表示顶级类别                |
    | description | text         | 是       |       | 类别描述                                                     |

2.  **物料信息表 (`materials_material`)**

    | 字段名        | 数据类型     | 是否为空 | 主键 | 备注                                                         |
    | :------------ | :----------- | :------- | :---- | :----------------------------------------------------------- |
    | id            | int          | 否       | 是    | 自增主键                                                     |
    | code          | varchar(50)  | 否       |       | 物料编码，唯一                                                 |
    | name          | varchar(255) | 否       |       | 物料名称                                                     |
    | spec         | varchar(255) | 是       |       | 规格型号                                                     |
    | unit         | varchar(20)  | 否       |       | 单位                                                         |
    | category      | int          | 否       |       | 物料类别 ID，外键关联 `materials_category` 表            |
    | safety_stock | int          | 是       |       | 安全库存量                                                     |
    | description | text         | 是       |       | 物料描述                                                     |

3.  **供应商表 (`materials_supplier`)**

    | 字段名     | 数据类型     | 是否为空 | 主键 | 备注                     |
    | :--------- | :----------- | :------- | :---- | :------------------------- |
    | id         | int          | 否       | 是    | 自增主键                 |
    | name       | varchar(255) | 否       |       | 供应商名称                 |
    | contact    | varchar(255) | 是       |       | 联系人                   |
    | phone      | varchar(20)  | 是       |       | 联系电话                 |
    | address    | varchar(255) | 是       |       | 地址                     |
    | description | text         | 是       |       | 描述                     |

**三、库存管理模块 (`inventory`)**

1.  **仓库表 (`inventory_warehouse`)**

    | 字段名     | 数据类型     | 是否为空 | 主键 | 备注                     |
    | :--------- | :----------- | :------- | :---- | :------------------------- |
    | id         | int          | 否       | 是    | 自增主键                 |
    | name       | varchar(255) | 否       |       | 仓库名称                 |
    | address    | varchar(255) | 是       |       | 仓库地址                 |
    | contact    | varchar(255) | 是       |       | 联系人                   |
    | phone      | varchar(20)  | 是       |       | 联系电话                 |
    | description | text         | 是       |       | 描述                     |

2.  **库存信息表 (`inventory_stock`)**

    | 字段名   | 数据类型 | 是否为空 | 主键 | 备注                                                         |
    | :------- | :------- | :------- | :---- | :----------------------------------------------------------- |
    | id       | int      | 否       | 是    | 自增主键                                                     |
    | material | int      | 否       |       | 物料 ID，外键关联 `materials_material` 表                 |
    | warehouse | int      | 否       |       | 仓库 ID，外键关联 `inventory_warehouse` 表                |
    | quantity | decimal  | 否       |       | 库存数量                                                     |

3.  **入库记录表 (`inventory_instock`)**

    | 字段名     | 数据类型 | 是否为空 | 主键 | 备注                                                         |
    | :--------- | :------- | :------- | :---- | :----------------------------------------------------------- |
    | id         | int      | 否       | 是    | 自增主键                                                     |
    | material   | int      | 否       |       | 物料 ID，外键关联 `materials_material` 表                 |
    | warehouse   | int      | 否       |       | 仓库 ID，外键关联 `inventory_warehouse` 表                |
    | quantity   | decimal  | 否       |       | 入库数量                                                     |
    | operator   | int      | 是       |       | 操作员 ID，外键关联 `core_user` 表                          |
    | created_at | datetime | 否       |       | 入库时间                                                     |

4.  **出库记录表 (`inventory_outstock`)**

    | 字段名     | 数据类型 | 是否为空 | 主键 | 备注                                                         |
    | :--------- | :------- | :------- | :---- | :----------------------------------------------------------- |
    | id         | int      | 否       | 是    | 自增主键                                                     |
    | material   | int      | 否       |       | 物料 ID，外键关联 `materials_material` 表                 |
    | warehouse   | int      | 否       |       | 仓库 ID，外键关联 `inventory_warehouse` 表                |
    | quantity   | decimal  | 否       |       | 出库数量                                                     |
    | operator   | int      | 是       |       | 操作员 ID，外键关联 `core_user` 表                          |
    | created_at | datetime | 否       |       | 出库时间                                                     |

**四、报表统计模块 (`reports`)**

报表统计模块的数据可以从其他模块的表中获取，一般不需要单独创建数据表。

**五、数据导入导出模块 (`data_manager`)**

1.  **模板表 (`data_manager_template`)**

    | 字段名      | 数据类型     | 是否为空 | 主键 | 备注                                                         |
    | :---------- | :----------- | :------- | :---- | :----------------------------------------------------------- |
    | id          | int          | 否       | 是    | 自增主键                                                     |
    | name        | varchar(255) | 否       |       | 模板名称                                                     |
    | description | text         | 是       |       | 模板描述                                                     |
    | content     | text         | 否       |       | 模板内容，例如：Excel 模板的字段定义、数据校验规则等，可以使用 JSON 格式存储 |






